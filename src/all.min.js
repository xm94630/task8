/* 作者：xm94630
 * 创建实例
 * angular.module第一个参数是模块“引用名”，模块间可以通过它引入依赖
 * 第11行代码中括号中就是通过“引用名”对模块的依赖引用，模块也可以理解为类似插件、服务的概念
 * “ui.bootstrap”模块定义是在script标签中引入的
 */
var	appServices    = angular.module('xmApp.services',[]),
    appDirectives  = angular.module('xmApp.directives',[]),
    appControllers = angular.module('xmApp.controllers',[]),
    appFilters     = angular.module('xmApp.filters',[]),
    xmApp          = angular.module('XM',['ui.router','ui.bootstrap','xmApp.services','xmApp.directives','xmApp.controllers','xmApp.filters']);
 
xmApp
	//全局变量注入
	.constant('HERO',{
		HP:1000,
		MP:2000
	})
    .run(["$rootScope", "$state", "$stateParams", function($rootScope, $state, $stateParams) {
    	//绑到根作用域，方便获得当前状态
        $rootScope.$state = $state;
        $rootScope.$stateParams = $stateParams;
    }]);
xmApp
    .config(["$stateProvider", "$urlRouterProvider", function($stateProvider, $urlRouterProvider) {

        $stateProvider
            .state('login', {
                url: '/login',
                views: {
                    'xmContent': {
                        templateUrl: './html/module/login.html',
                        controller: 'loginCtrl'
                    }
                }
            })
            .state('home', {
                url: '/home',
                views: {
                    'xmContent': {
                        templateUrl: './html/module/home.html',
                        controller: 'homeCtrl'
                    }
                }
            });

        $urlRouterProvider
            .when('/', '/login')
            .otherwise('/404');

    }]);
//自定义服务
appServices.factory('XmService', ["$rootScope", function ($rootScope) {
    return {
        splat:function(fun){
        	return function(array){
        		return fun.apply(null,array);
        	}
        }
    };
}]);
appDirectives.directive('dialogDirective', function() {
	return {
	    restrict: 'AE',
	    replace: 'true',
	    templateUrl: './html/directive/dialog.html'
	    //template: '<div>我是指令哦</div>'
	};
});

/**
 * Created by Administrator on 2016/1/27.
 */
appControllers.controller("homeCtrl",["$scope", "XmService", function($scope,XmService){

	//这里使用了服务
	var value = XmService.splat(function(x,y){
		return x+y;
	})([1400,8127]);

	$scope.id = value;

}]);
appControllers.controller("loginCtrl",["$scope", "HERO", function($scope,HERO){
    $scope.name = '登陆页怪兽君，生命值是'+HERO.MP;
}]);
